{"paragraphs":[{"text":"import org.apache.log4j.{Level, Logger}\r\nimport org.apache.spark.broadcast.Broadcast\r\nimport org.apache.spark.SparkConf\r\nimport org.apache.spark.ml.recommendation.{ALS, ALSModel}\r\nimport org.apache.spark.sql.functions._\r\nimport org.apache.spark.sql.{DataFrame, Dataset, SparkSession}\r\nimport scala.collection.Map\r\nimport scala.util.Random","user":"anonymous","dateUpdated":"2018-05-19T14:43:45+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.log4j.{Level, Logger}\nimport org.apache.spark.broadcast.Broadcast\nimport org.apache.spark.SparkConf\nimport org.apache.spark.ml.recommendation.{ALS, ALSModel}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.{DataFrame, Dataset, SparkSession}\nimport scala.collection.Map\nimport scala.util.Random\n"}]},"apps":[],"jobName":"paragraph_1526740885645_-1871533038","id":"20180519-032634_1323027931","dateCreated":"2018-05-19T14:41:25+0000","dateStarted":"2018-05-19T14:43:45+0000","dateFinished":"2018-05-19T14:43:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2533"},{"text":"val conf = new SparkConf().setAppName(\"WordsRecommender\").setMaster(\"local[*]\").set(\"spark.executor.memory\", \"2g\")\r\nval spark = SparkSession.builder().config(conf).getOrCreate()\r\nval sc = spark.sparkContext","user":"anonymous","dateUpdated":"2018-05-19T14:43:48+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"conf: org.apache.spark.SparkConf = org.apache.spark.SparkConf@3d555174\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@560e9877\nsc: org.apache.spark.SparkContext = org.apache.spark.SparkContext@473852c7\n"}]},"apps":[],"jobName":"paragraph_1526740885660_-1864992306","id":"20180519-033404_1122184446","dateCreated":"2018-05-19T14:41:25+0000","dateStarted":"2018-05-19T14:43:48+0000","dateFinished":"2018-05-19T14:43:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2534"},{"text":"%sh curl \"https://raw.githubusercontent.com/Igorock/teach-machine-to-teach/master/data/user-words/en-words-20k.txt\" -o en-words-20k.txt\ncurl \"https://raw.githubusercontent.com/Igorock/teach-machine-to-teach/master/data/user-words/full-list-of-bad-words.csv\" -o full-list-of-bad-words.csv\ncurl \"https://raw.githubusercontent.com/Igorock/teach-machine-to-teach/master/data/user-words/user_word_count.csv\" -o user_word_count.csv\ncurl \"https://raw.githubusercontent.com/Igorock/teach-machine-to-teach/master/data/user-words/words.csv\" -o words.csv\ncurl \"https://raw.githubusercontent.com/Igorock/teach-machine-to-teach/master/data/user-words/word_alias.csv\" -o word_alias.csv","dateUpdated":"2018-05-19T14:43:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/sh","results":{},"enabled":true,"editorSetting":{"language":"sh","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100  151k  100  151k    0     0   340k      0 --:--:-- --:--:-- --:--:--  341k\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100 11389  100 11389    0     0  33626      0 --:--:-- --:--:-- --:--:-- 33695\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100  758k  100  758k    0     0  1613k      0 --:--:-- --:--:-- --:--:-- 1613k\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100  641k  100  641k    0     0  1356k      0 --:--:-- --:--:-- --:--:-- 1358k\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r100  761k  100  761k    0     0  1566k      0 --:--:-- --:--:-- --:--:-- 1564k\n"}]},"apps":[],"jobName":"paragraph_1526740885661_-1865377055","id":"20180519-033442_1597663858","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2535","user":"anonymous","dateFinished":"2018-05-19T14:43:55+0000","dateStarted":"2018-05-19T14:43:52+0000"},{"text":"val userWordData = spark.read.option(\"header\", \"true\").csv(\"user_word_count.csv\")\nval rawWordData = spark.read.option(\"header\", \"true\").csv(\"words.csv\")\nval wordAlias = spark.read.option(\"header\", \"true\").csv(\"word_alias.csv\")\nval badWords = spark.read.csv(\"full-list-of-bad-words.csv\").toDF(\"name\")\nval allEnglishWords = spark.read.textFile(\"en-words-20k.txt\").toDF(\"name\")\n\n\nval wordData = rawWordData.join(badWords, Seq(\"name\"), \"leftanti\")\n    .join(allEnglishWords, Seq(\"name\"))\n    .filter(col(\"name\") rlike \"\\\\b[^\\\\d\\\\W]{3,}+\\\\b\")\n    \nz.show(wordData)","dateUpdated":"2018-05-19T14:44:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526740885662_-1864222808","id":"20180519-052023_2034390088","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2536","user":"anonymous","dateFinished":"2018-05-19T14:44:40+0000","dateStarted":"2018-05-19T14:44:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"userWordData: org.apache.spark.sql.DataFrame = [user: string, artist: string ... 1 more field]\nrawWordData: org.apache.spark.sql.DataFrame = [id: string, name: string]\nwordAlias: org.apache.spark.sql.DataFrame = [id: string, alias: string]\nbadWords: org.apache.spark.sql.DataFrame = [name: string]\nallEnglishWords: org.apache.spark.sql.DataFrame = [name: string]\nwordData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [name: string, id: string]\n"},{"type":"TABLE","data":"name\tid\ndemocratic\t664\ndivisions\t39029\ncause\t19585\nsigned\t8617\naccountancy\t15484\ncorpus\t63167\nended\t48397\ntons\t39945\npredictable\t51240\nhoped\t38887\ngatherings\t20396\nwidely\t24023\nleased\t15376\nwarrior\t37263\ndefinitive\t17709\ndifference\t25051\nmud\t23605\nthreats\t23415\ngeometric\t13126\nmeter\t16793\njolly\t42976\nwalking\t5120\ndeparted\t8142\nknife\t12424\nthereof\t49453\nfence\t22829\ncontroller\t19910\npound\t2870\nswell\t22838\npending\t3043\nadvance\t2276\nhesitate\t2411\ndelight\t8595\nrenewable\t54084\nimage\t818\nreasonable\t23199\ncase\t64425\ninfect\t48663\nglacier\t69433\nparental\t20890\nfolds\t27368\nfleece\t65667\nhen\t38479\nlegacy\t29782\nrequests\t7568\nclose\t12936\npremises\t46939\nresources\t3152\npat\t29981\nfully\t45036\nappeals\t25650\nerrors\t26380\nprofit\t55631\nmattress\t36410\nopenness\t20311\nengine\t12910\nultimate\t17505\naxis\t35510\ndrained\t34791\ngrandma\t41715\npermanent\t20304\nsmall\t179\nhence\t15461\nfracture\t51868\nguides\t19898\nparking\t8598\nbleeding\t23223\noriginal\t5538\nscale\t21034\nmetal\t27970\npetty\t54668\nreminders\t22584\nbobby\t14545\nfalcon\t37270\nalterations\t39869\nexams\t44086\nshareholders\t34287\nhavoc\t27975\nserving\t16601\nwell\t6962\ncrashes\t90\nfridge\t39771\nunderstand\t21999\nladders\t47983\ninsult\t20928\nhazard\t21709\nexpressions\t29004\nnotes\t55035\nfascinating\t16539\nalgae\t25942\ncustom\t548\nlisten\t5136\nexecute\t11042\nthemselves\t17208\naudiences\t68831\ntanned\t21768\nequipment\t16696\nthumbnails\t12041\ndig\t14937\ndumping\t11869\ncoat\t31464\naccountant\t2530\ndecreased\t32326\ntrunk\t27203\nhigher\t32665\nfloods\t38302\nfederal\t3772\nprice\t27495\nlovely\t26722\neasier\t13329\nsubsequent\t30510\ndegrees\t25767\nroommate\t12321\nproviding\t31920\nvulnerabilities\t26212\npant\t59676\nscheme\t5616\nexpires\t34950\nmusicians\t40199\nreveal\t28443\ndiseases\t47290\nprosecution\t662\nflop\t18563\nlens\t66384\nfriction\t11373\nstored\t15372\ninforms\t2712\nireland\t16923\ncrimson\t52587\ncelestial\t33801\ngreen\t252\nkrishna\t22939\nclassify\t69388\ncutter\t30282\ninvestments\t31649\ndrove\t3328\noverhead\t39376\nmessages\t4920\ninsure\t22112\ngrow\t16452\nlabel\t2877\nvie\t12583\nemphasizes\t64774\ninstalled\t3792\neverybody\t16453\ndelivered\t708\nmind\t731\nsuperintendent\t44566\noptions\t17580\noneself\t31472\nspun\t40120\narmed\t11598\npre\t17227\nmedia\t68720\nadults\t19959\nstriving\t57721\nclue\t8499\nfailing\t24976\npursuing\t26586\nnull\t51942\nconferred\t30657\nreceive\t18851\npests\t29396\nbethesda\t58670\ndisable\t2663\njersey\t24066\ndramatically\t33004\nwasting\t23768\nfaith\t23460\ndilemma\t66861\ntriple\t27029\ntherefore\t4123\nowed\t47484\nsuppression\t48668\nbuilder\t3659\nfierce\t25624\ndisplayed\t1042\nedition\t14201\nalternatively\t3663\nrescue\t24736\nacceptable\t23257\nsorting\t6073\nguys\t35257\ngym\t18005\nafraid\t20955\ntricks\t65521\ncontrary\t5157\nperfect\t3723\nhas\t2843\ndeeper\t24338\nmeadows\t38354\nunresolved\t1152\ncomplementary\t30992\nregulations\t15540\nheadings\t34775\nerr\t40034\ngirl\t5459\nprobe\t21906\nposted\t2871\npersonal\t12605\npharmacist\t42171\nscrap\t44867\narguably\t18490\nlesson\t7140\nvanity\t5202\nbreaker\t62712\nabnormal\t49977\nstem\t45030\nlawmakers\t11285\ncheeks\t13070\ninduced\t25769\nspecificity\t15482\ncompromise\t98\nexpects\t11290\nmosquito\t7395\nmerchant\t19211\npublic\t3654\npattern\t10802\nflesh\t62598\nappearance\t1001\nretention\t20365\npastel\t21498\nbacon\t20005\nprescribed\t47129\nintroduces\t55729\nresource\t37043\nlift\t26457\nmemories\t18642\ndesert\t34161\nsting\t11348\nflush\t9241\nexploit\t21266\nslopes\t35742\nnordic\t12323\nperpetual\t5835\nshortcut\t69420\nincentive\t31383\nquietly\t37391\nawful\t5325\nperennial\t23517\ngirls\t9004\nbalance\t8082\nprop\t17672\npan\t36660\nsynthesis\t39531\nbriefly\t18717\nbringing\t19717\ngender\t14939\nrinse\t58599\nobliged\t4345\nwhip\t6207\ntalk\t27407\nundoubtedly\t5236\nbass\t13202\nseizures\t42777\nclick\t1037\nstandpoint\t20551\nfails\t53759\nadvantage\t4144\nfears\t26563\ncounter\t13607\nsoothing\t43031\nsegments\t65813\nornamental\t44447\nperforms\t47862\nimplied\t9743\nmoody\t4822\nmotor\t27470\ndefault\t24554\nplunge\t49687\ntechnical\t21002\ncould\t5061\nally\t57690\ncircle\t35544\nredemption\t20366\nbase\t34005\nsucked\t56045\nwilling\t20059\nvisibility\t1642\nacid\t26498\nmus\t31493\nwake\t36474\nspecs\t30419\noath\t42501\nsky\t4908\nmovie\t7084\ndenied\t41725\nwere\t161\ndetectors\t52001\nmoves\t17501\nindustry\t1283\nones\t27640\nnormal\t25009\nencourages\t21305\nwwf\t4498\npursuant\t24506\nsink\t7430\nbumper\t50970\nnausea\t21773\narms\t13160\npharmacology\t22932\nend\t1336\ndecrease\t18880\nbenjamin\t17431\npermissions\t9913\ndistressed\t47120\nstamp\t35571\npunch\t6388\ntone\t658\ndefender\t51445\nuptown\t40282\nmaterials\t16697\nprobes\t22616\noffset\t27050\nlate\t16712\ninteract\t28463\nblessed\t28995\nexpertise\t16924\nhour\t14148\ndiscontinued\t18416\napartment\t2867\nincrements\t42217\nglu\t25699\nthose\t39052\njournalists\t3794\nlife\t7023\nconsistency\t29884\nsalvation\t33249\npep\t32008\ngeneration\t4991\nremove\t3041\npremise\t16510\nchapter\t622\nharder\t49899\npressure\t25768\ncontribution\t57671\nshare\t904\nwindy\t37475\nexhibition\t6426\nincredibly\t26094\ntally\t36721\nbasic\t879\nbegan\t17590\nvoyage\t23746\nclub\t13095\nheaded\t30013\nprey\t41711\nrhythm\t38256\nelectron\t33978\ncope\t68921\nrode\t43630\nonto\t34552\naltered\t37926\nolder\t4581\nmerchantability\t40879\nconstitute\t18289\nlows\t27121\nties\t32392\ntranscripts\t37382\nregistrar\t34108\nascertain\t54451\ntab\t12618\nquality\t16542\ndesserts\t66311\ndispose\t66111\nzoom\t806\nextremely\t22355\ntired\t34484\nauthority\t31816\nmasturbating\t25710\nnowadays\t35746\npledge\t24731\nobject\t22167\nbattle\t27268\nregulatory\t56484\nattempts\t20295\npersistent\t1108\ninterim\t43375\naboriginal\t50284\nschedule\t5833\nmoose\t52511\nhomosexual\t1109\ncounty\t17256\nborder\t517\nsuspense\t39725\npeanut\t50057\nmouth\t7398\nwalk\t15936\nprev\t18796\nlas\t13208\niris\t66529\npressures\t49206\nrainbow\t41153\nframework\t1082\nredundancy\t20341\ndamage\t10954\ndoc\t42963\nkitchen\t56604\nmay\t547\nthought\t750\nbishop\t24896\nunusual\t10700\nincreased\t36876\nfire\t26920\nlively\t27362\nattorney\t6433\ngalaxy\t375\nonions\t53189\nsunlight\t2282\nweb\t735\nfreshmen\t21529\nage\t47364\ncosmopolitan\t28221\nchaser\t52905\nlocal\t144\nnavigation\t5380\ncables\t39610\nasserted\t41499\ncustomer\t2401\nprominent\t5919\ntypes\t19969\nlives\t4824\nslips\t35160\nserved\t20153\nout\t12642\nheel\t47266\ndiscourse\t37438\nstation\t11068\nstate\t10390\ngenome\t63194\nanimated\t58141\nliteracy\t26464\nproposed\t41844\ndeliberately\t3577\nhitchcock\t39726\npillows\t66216\ndumped\t21459\nraid\t533\ninclude\t12523\ncooperative\t30758\naboard\t32108\nmerit\t5025\nwrapping\t13484\ncalled\t464\nsurgeons\t63108\nmodel\t21039\nloyalty\t3619\nholders\t67530\nthank\t16451\nmuslims\t8820\narbitrary\t23854\navid\t24393\nhungry\t7141\nmana\t8963\nsheet\t10789\naesthetic\t13879\nblow\t18771\ndisc\t25845\nflexibility\t26351\nlock\t33847\nhearing\t968\ndent\t37302\nimpossible\t11287\nunacceptable\t58841\nnotice\t263\npercentage\t21735\nportable\t31238\nmessenger\t44957\ndamaging\t68830\napparent\t580\ncommenced\t28560\nfavor\t23227\nplease\t7788\nson\t20841\nsurprising\t20976\nrevenues\t25132\nsegment\t35413\nmiles\t40263\nchallenging\t566\npopular\t3153\nclassic\t11217\nretreat\t25622\nconceived\t15109\nsuppose\t33289\nbenchmarks\t64506\nfaced\t9458\nscattered\t21265\npremature\t31350\nacting\t2856\nexcited\t25080\naccident\t56905\ncharts\t3859\nchemicals\t61680\nowl\t7486\nslash\t14561\nlook\t7349\ngreater\t3203\ndamages\t67930\nwaking\t17520\nvalued\t20532\nsubdivision\t47686\njames\t32053\nstandalone\t36368\nnice\t3667\nexceeded\t64636\noccupied\t20210\nwisely\t26273\nshortly\t33415\nhumble\t24848\nsave\t2631\naimed\t15571\nmodeling\t63716\ncommitted\t17756\ndetail\t12639\ntis\t45982\nbrother\t4399\nbacked\t7578\nspike\t26276\nquizzes\t20243\nenrichment\t28970\nmeasurements\t31327\nanything\t22150\nimpedance\t62353\nwacky\t28041\nsack\t42906\ntalking\t2743\nlicense\t18412\nfulfilled\t32269\nback\t11603\nfiles\t8238\nadmin\t8901\nfactory\t45569\nathens\t30241\nshirt\t32832\nkai\t40552\nfreak\t21478\nhandful\t38369\nbehalf\t15522\ntyranny\t46542\nhan\t14408\nmug\t58450\nparadise\t8186\nonyx\t39586\nsorry\t3682\nseptember\t36486\ntiny\t9259\npreferred\t40397\ngranted\t1853\noutdoors\t28588\nuniversities\t36927\ndeutschland\t42673\nrental\t27873\ndiluted\t29164\nestimation\t6167\nexported\t36009\ncondemned\t17493\nforgiveness\t19521\nsubstantially\t43994\nship\t15744\nwithheld\t5654\ngovern\t8751\ndownload\t271\nunaware\t23682\nsupports\t60544\nbazaar\t44388\nwriting\t7630\nprocedure\t35828\nevolution\t12212\nchart\t16279\npreferable\t55215\npiles\t54281\ninternships\t30300\nstatus\t1151\ncompletion\t8408\nacknowledge\t8800\nobtain\t18861\nseems\t6964\nextending\t31084\nsoldiers\t22762\nenforce\t35314\nglobe\t690\nprocessor\t58805\nuniversity\t327\ndurability\t65878\ncompatible\t26385\nshoots\t46908\npresentation\t647\ncleanliness\t46221\nquickly\t44069\nprograms\t36921\nfemales\t17598\ngrade\t21146\ndolls\t36891\noven\t17783\ndropped\t23967\ndorm\t21470\nsailing\t33450\nhorse\t7102\ngeeks\t40685\ngoto\t48952\nonsite\t35193\nlooked\t20137\nboil\t23041\ndial\t28897\nsketches\t39217\noops\t15565\nmillion\t2001\nburden\t2162\nterrain\t20993\nconvert\t85\ndip\t18127\nbuzz\t56686\nflorida\t16491\ndraw\t7444\nsnapshot\t69049\nimplication\t28534\nword\t7\nconstruction\t18027\nfuture\t9210\nswedish\t28934\nbecome\t2787\npleasures\t26130\nivory\t2239\npray\t45212\nniche\t1457\nsoftware\t25304\nslipped\t2283\ning\t8815\nresignation\t8799\nnotification\t5410\nenjoy\t40090\nhighlands\t28238\nschool\t35858\nworkshop\t57752\nveronica\t62330\ncurtain\t31617\nimportant\t655\nchords\t40051\ncigarettes\t45451\nflag\t706\nmagazines\t19939\nbirthday\t12982\ndecember\t41651\naliases\t47591\ncorporation\t39377\ntumble\t28529\ncurrent\t325\nforefront\t28842\ndeutsch\t17260\nreverend\t38155\nnor\t57684\nsubway\t39434\nprobability\t15583\nmetabolism\t68141\nsat\t21388\npot\t21183\ngoggles\t27759\nfreedom\t66361\nmike\t14657\nkin\t1279\ncount\t18881\nformat\t11986\nrules\t17220\ngameplay\t37751\naccelerate\t16187\navailability\t33691\nworks\t4989\nhumanities\t9709\nmagnitude\t25492\ngermany\t35869\nleap\t11361\nfame\t21385\ngladly\t20900\nresult\t1036\nhousing\t52325\nown\t3636\nambient\t45963\nidentified\t69271\nmassive\t32733\nconfirmation\t15386\ncollateral\t27045\nsec\t36827\ncareer\t1111\nfusion\t36633\nnumerous\t15399\nassumption\t29893\naction\t8376\ntells\t60448\ndisco\t28799\nsoft\t1239\nchubby\t21761\nsomewhat\t4357\nacquiring\t69275\nlocker\t36151\nprophet\t21793\nsensible\t5599\npatches\t31959\nbounded\t46092\nstew\t42920\nsuicide\t27195\nbunch\t35049\nexodus\t69114\nplaster\t58594\ntire\t24719\nbat\t34363\nmain\t18804\nincorporate\t13867\ncmp\t40462\nbooth\t53206\nperformed\t15512\nmomentum\t26291\nrepresenting\t33781\nauthorization\t7448\ncolleague\t25414\nyes\t8193\nignore\t49755\ndependence\t25566\nadequately\t50706\ngas\t25753\nintervention\t54800\ninnovation\t29937\nsanity\t23694\nconcise\t25050\ndescribing\t1498\nshares\t28208\nbirth\t598\nconsiderations\t38925\ndownloaded\t49765\nvary\t12062\nasynchronous\t34190\nwhat\t3342\nover\t2785\nshore\t42690\ninterface\t2829\nclown\t42282\nthrough\t2146\nowning\t39512\ngifts\t38224\nintern\t51326\nroute\t5411\nciting\t27649\ndsl\t34102\nassert\t50446\nbundle\t28556\nwitnessed\t39568\ndepression\t8847\ntrainees\t15448\ndisorder\t11228\ndigit\t50713\nusual\t11429\ndisclaimers\t21711\nformula\t64174\nvolatile\t7654\nricardo\t31795\nrefrain\t39359\nacross\t418\nrevolt\t37355\nsnake\t12827\npartition\t33734\ninternationally\t35867\nforex\t45448\ncereal\t32627\nharp\t6676\nregularly\t68067\nusername\t2596\ndetermining\t4337\ncopyright\t10804\npublication\t35862\nsupervisor\t23083\nbrutal\t22904\nsar\t39903\nclamp\t51299\nfog\t16827\nalter\t35323\nsingh\t5361\nshows\t8089\nspice\t55044\nobviously\t6043\ndemonstrates\t573\ntoes\t67200\nplotting\t41454\nupright\t2190\ncomprehensive\t6067\nsituation\t22555\ndisorders\t35074\nindustrial\t8927\neight\t39971\nscent\t2166\ncontraction\t32544\nprogrammers\t15412\nlocally\t34196\nhilton\t8824\ndoctor\t41093\npolling\t21030\ndon\t43687\nkinds\t17602\ncontinue\t14952\nfinder\t51053\naccepted\t20139\nwho\t2759\nchanging\t64178\nrecess\t38209\nelevated\t2222\nmoscow\t18359\ngovernor\t3101\nbackwards\t34878\nlowered\t48088\noccult\t66166\ncomplement\t38407\ndiscovery\t9157\nbefore\t749\nvertices\t32938\nimportance\t17199\nplain\t2360\nfederated\t65982\nroutine\t8422\nretirement\t25360\nbucks\t31240\nreclamation\t68730\nofficially\t743\nmanners\t4398\ndetector\t40883\ndrums\t7416\nvenues\t32150\ncharmed\t51540\nnest\t8474\ncreativity\t5548\ntulip\t22390\ntransferable\t12909\nconsumer\t11809\nbreaks\t21852\nminded\t30772\ncurved\t23536\nquotes\t69272\ncalc\t20246\nconvinced\t2134\ninteroperability\t40492\nprobation\t54181\nrepeat\t2490\nnesting\t21916\neligibility\t42784\nunfortunate\t57722\nshapes\t20000\nbehold\t51494\noccurrences\t62659\nbureau\t30820\nsubstitutes\t35112\ndeficient\t4676\ndiscover\t38555\nforget\t12458\nabatement\t48866\nfavour\t22649\ntails\t65492\napparel\t6099\ndiffers\t23330\nbias\t6602\nbear\t2132\nlicensed\t65715\ncrackers\t67815\nrecent\t17498\ncompelling\t8183\nquarter\t11808\ntowers\t19711\npolynomial\t58569\ncheerful\t5625\nblonde\t60251\nfluffy\t24585\ncomforter\t62596\nsign\t8618\nmist\t8540\nunbiased\t30900\ngarbage\t861\ntaught\t15939\narthritis\t61673\nsuperficial\t25778\nexclusive\t11326\npupils\t61602\ncost\t55616\nwool\t64746\nhatch\t20127\nbob\t19506\ncrash\t214\nrequires\t1612\nmaster\t9994\ncomposed\t2524\nappear\t27546\nlevels\t35895\ncompass\t36583\nreveals\t26216\nusable\t11425\nbehave\t61277\nstable\t69028\nkeyboard\t8708\nholy\t11379\nsibling\t6058\nrolls\t39935\ninvoked\t26168\nrecurrence\t49922\nnato\t60080\ntiming\t66761\ndecide\t16440\nmorning\t7501\nstated\t8102\nbounds\t40613\ninaccuracies\t30284\nunknown\t29351\nterribly\t22823\nsocket\t39599\nrevised\t34681\nsorted\t2846\nerror\t510\nity\t62833\nclosest\t19596\nsuccessful\t35876\nrear\t38062\nadvancement\t57683\nmono\t59376\nrewards\t20514\npatients\t15103\nheadphones\t24438\nfounded\t36501\nincorrect\t1516\nseriously\t51348\nrecruit\t18850\nholiday\t19109\nwave\t58639\nmerged\t2556\nexpectations\t15932\nwholly\t49398\nfuzzy\t57698\nmeans\t13238\naddictive\t8421\ncradle\t26401\ndog\t5\nleather\t32\npaved\t20158\naddicted\t54417\nyork\t34213\nshields\t23124\nstationary\t25582\nrepresented\t26924\nliable\t34052\nstance\t26451\ndiagnose\t15593\nlizard\t37167\nproject\t272\navoiding\t23972\ntriangle\t7550\nparticipant\t30974\nstring\t699\nkilled\t29127\nfeat\t16854\nvat\t56344\nstreaming\t35607\nsettle\t21772\npad\t932\nfebruary\t21651\nretrieve\t3678\ndependent\t34596\nregret\t21851\ndownloads\t35928\noverview\t9526\ndeserve\t23176\nfields\t6341\ncelebrated\t19394\nprinciple\t31275\nconstructing\t54017\nbroad\t30817\ninfrastructure\t30636\nwhy\t49107\nlunch\t32552\namber\t7746\nmortar\t18131\ntechnological\t30781\naccidentally\t18454\nwheeled\t47214\nbush\t7417\nbreath\t12442\ncozy\t16700\naccomplish\t2944\nqueries\t41256\ncalculus\t473\nutility\t5020\nfought\t40298\nrepair\t23510\nachievement\t2940\ndrafts\t9477\ninterpret\t2923\ncommonwealth\t42587\nfischer\t39985\nrightly\t67982\nvalue\t684\nseals\t38165\nbuyers\t29940\nalmond\t23534\ndive\t27749\ngalore\t49442\nfoul\t39489\nboredom\t20922\nsuffers\t41359\n<!--TABLE_COMMENT-->\n<font color=red>Results are limited by 1000.</font>"}]}},{"text":"val wordAliasMap = wordAlias.collect().map { line =>\r\n  (line.getString(0).toInt, line.getString(1).toInt)}.toMap\r\n      \r\nval bWordAlias = spark.sparkContext.broadcast(wordAliasMap)","dateUpdated":"2018-05-19T14:46:22+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wordAliasMap: scala.collection.immutable.Map[Int,Int] = Map(53767 -> 53767, 32571 -> 9949, 42890 -> 42890, 46805 -> 7758, 37159 -> 37159, 29176 -> 29176, 14221 -> 14221, 2163 -> 2163, 37041 -> 17547, 62232 -> 62232, 8607 -> 8607, 60426 -> 26294, 25695 -> 25695, 13950 -> 13950, 31843 -> 31843, 20873 -> 20873, 23162 -> 23162, 39241 -> 39241, 64790 -> 64790, 42900 -> 30886, 69439 -> 69439, 16466 -> 16466, 67614 -> 67614, 55558 -> 55558, 53060 -> 53060, 28337 -> 28337, 49828 -> 49828, 50400 -> 50400, 29862 -> 29862, 39049 -> 2252, 69397 -> 69397, 19887 -> 19887, 35178 -> 35178, 41742 -> 41742, 39858 -> 515, 54355 -> 54355, 18180 -> 18180, 69939 -> 22624, 16383 -> 16383, 36308 -> 36308, 31885 -> 31885, 892 -> 892, 69 -> 69, 51261 -> 51261, 35370 -> 35370, 53550 -> 53550, 45704 -> 45704, 6615...bWordAlias: org.apache.spark.broadcast.Broadcast[scala.collection.immutable.Map[Int,Int]] = Broadcast(36)\n"}]},"apps":[],"jobName":"paragraph_1526740885662_-1864222808","id":"20180519-063027_1289705272","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2537","user":"anonymous","dateFinished":"2018-05-19T14:46:23+0000","dateStarted":"2018-05-19T14:46:22+0000"},{"text":"val groupedWordData = userWordData.map { line =>\r\n  val (userID, wordID, count) = (line.getString(0).toInt, line.getString(1).toInt, line.getString(2).toInt)\r\n  val finalWordID = bWordAlias.value.getOrElse(wordID, wordID)\r\n  (userID, finalWordID, count)\r\n}.toDF(\"user\", \"word\", \"count\")\r\n\r\nz.show(groupedWordData)","dateUpdated":"2018-05-19T14:47:47+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"groupedWordData: org.apache.spark.sql.DataFrame = [user: int, word: int ... 1 more field]\n"},{"type":"TABLE","data":"user\tword\tcount\n7\t3\t6\n7\t443\t5\n8\t33\t4\n12\t33\t4\n12\t40\t4\n7\t2889\t3\n7\t15723\t3\n7\t547\t3\n7\t479\t3\n7\t8169\t3\n7\t18839\t3\n7\t43026\t3\n1\t386\t3\n7\t887\t3\n7\t5\t3\n450\t40\t3\n7\t8692\t3\n1\t686\t3\n7\t18859\t3\n7\t483\t3\n7\t15411\t3\n405\t184\t3\n7\t12825\t3\n1\t954\t3\n1\t252\t3\n7\t386\t3\n7\t676\t3\n1\t483\t3\n7\t18167\t3\n1\t196\t3\n7\t92\t3\n431\t1615\t2\n337\t24062\t2\n431\t23123\t2\n1616\t48666\t2\n1616\t48130\t2\n431\t47490\t2\n7\t5873\t2\n405\t1181\t2\n124\t19700\t2\n6515\t55036\t2\n7\t18881\t2\n102\t549\t2\n431\t701\t2\n316\t26292\t2\n405\t22959\t2\n172\t36435\t2\n148\t311\t2\n148\t22145\t2\n148\t20034\t2\n146\t6072\t2\n324\t1752\t2\n148\t5752\t2\n311\t1278\t2\n124\t18899\t2\n1\t7100\t2\n1616\t4112\t2\n405\t39697\t2\n7\t59199\t2\n148\t31023\t2\n313\t8714\t2\n7\t8176\t2\n12\t179\t2\n7\t26243\t2\n7\t1662\t2\n146\t20373\t2\n479\t28681\t2\n6855\t65023\t2\n337\t23612\t2\n7\t18893\t2\n30\t19993\t2\n148\t1181\t2\n432\t35094\t2\n7\t15588\t2\n1\t351\t2\n7\t18897\t2\n1616\t225\t2\n7\t2771\t2\n316\t1278\t2\n375\t33922\t2\n431\t34395\t2\n187\t325\t2\n356\t382\t2\n313\t27977\t2\n7\t2610\t2\n316\t1919\t2\n7\t33695\t2\n7\t18884\t2\n1\t685\t2\n124\t15515\t2\n316\t11466\t2\n148\t11448\t2\n316\t346\t2\n1\t105\t2\n416\t38407\t2\n12\t393\t2\n316\t35590\t2\n1616\t21987\t2\n476\t3897\t2\n102\t8183\t2\n7\t18849\t2\n1\t37746\t2\n132\t19755\t2\n124\t19699\t2\n3993\t2213\t2\n1616\t48129\t2\n316\t23660\t2\n375\t7349\t2\n12\t351\t2\n479\t52529\t2\n1\t328\t2\n12\t331\t2\n431\t2146\t2\n375\t37912\t2\n1\t646\t2\n476\t302\t2\n37\t19898\t2\n316\t18771\t2\n7\t23605\t2\n1616\t50299\t2\n1\t605\t2\n7\t18861\t2\n1\t93\t2\n205\t25724\t2\n7\t15905\t2\n7\t18896\t2\n316\t31918\t2\n416\t6432\t2\n316\t1525\t2\n375\t4112\t2\n148\t19993\t2\n372\t27812\t2\n7\t1609\t2\n405\t38866\t2\n316\t38962\t2\n7\t8016\t2\n7\t9517\t2\n7\t38792\t2\n316\t29587\t2\n148\t20385\t2\n160\t20174\t2\n172\t26723\t2\n416\t7581\t2\n312\t16282\t2\n375\t43555\t2\n7\t1005\t2\n7\t20228\t2\n4033\t16505\t2\n7\t18843\t2\n7\t18876\t2\n1\t568\t2\n124\t2784\t2\n479\t47667\t2\n148\t19942\t2\n476\t13975\t2\n405\t39132\t2\n7\t18864\t2\n148\t21791\t2\n7\t10862\t2\n148\t821\t2\n316\t23578\t2\n1\t110\t2\n7\t16817\t2\n333\t15328\t2\n1\t726\t2\n1\t7276\t2\n316\t376\t2\n7\t149\t2\n7\t330\t2\n7\t18854\t2\n144\t21276\t2\n479\t61506\t2\n7\t2464\t2\n7\t8625\t2\n431\t46880\t2\n7\t10367\t2\n476\t8692\t2\n316\t2412\t2\n324\t24026\t2\n1\t727\t2\n431\t2252\t2\n30\t4177\t2\n316\t23204\t2\n1\t107\t2\n309\t24136\t2\n1\t769\t2\n316\t5369\t2\n12\t390\t2\n405\t35041\t2\n84\t2775\t2\n1616\t50327\t2\n30\t20109\t2\n1\t7597\t2\n148\t58\t2\n12\t149\t2\n7\t18867\t2\n312\t26466\t2\n316\t15402\t2\n1616\t36475\t2\n1\t577\t2\n7\t8187\t2\n1\t1588\t2\n512\t316\t2\n148\t29420\t2\n1\t328\t2\n316\t2127\t2\n316\t787\t2\n1616\t41442\t2\n311\t3714\t2\n375\t35894\t2\n375\t22354\t2\n148\t339\t2\n5775\t5396\t2\n479\t1107\t2\n375\t32693\t2\n1\t198\t2\n186\t548\t2\n375\t1615\t2\n124\t17718\t2\n476\t460\t2\n431\t1238\t2\n405\t18432\t2\n6430\t20676\t2\n375\t737\t2\n1\t636\t2\n148\t1090\t2\n7\t978\t2\n5775\t23475\t2\n316\t845\t2\n1616\t48862\t2\n148\t20645\t2\n375\t1278\t2\n132\t19821\t2\n37\t174\t2\n1616\t48128\t2\n148\t20445\t2\n7\t18883\t2\n1\t640\t2\n7\t7569\t2\n479\t49701\t2\n316\t12806\t2\n148\t4125\t2\n375\t32251\t2\n30\t39569\t2\n30\t53964\t2\n31\t2040\t2\n148\t29382\t2\n148\t31260\t2\n431\t15380\t2\n1\t109\t2\n316\t15262\t2\n316\t33382\t2\n148\t20077\t2\n148\t554\t2\n375\t34069\t2\n7\t66148\t2\n146\t20397\t2\n30\t5163\t2\n7\t18895\t2\n7\t6222\t2\n316\t2447\t2\n51\t16835\t2\n1\t736\t2\n12\t7\t2\n7\t5134\t2\n186\t548\t2\n30\t149\t2\n7\t18846\t2\n416\t19982\t2\n479\t40868\t2\n7\t20378\t2\n405\t39698\t2\n316\t39206\t2\n479\t62863\t2\n479\t47038\t2\n311\t26574\t2\n7\t18845\t2\n316\t11578\t2\n431\t21639\t2\n124\t19380\t2\n352\t2876\t2\n7\t18885\t2\n316\t20363\t2\n405\t39282\t2\n498\t43764\t2\n7\t7629\t2\n316\t4144\t2\n7\t527\t2\n1\t197\t2\n186\t24263\t2\n30\t53930\t2\n324\t24052\t2\n7\t3636\t2\n316\t32629\t2\n186\t21121\t2\n7\t18900\t2\n7\t1049\t2\n7\t3577\t2\n124\t360\t2\n7\t4416\t2\n1616\t48651\t2\n316\t23021\t2\n5775\t20443\t2\n30\t14512\t2\n132\t19707\t2\n7\t17681\t2\n124\t19698\t2\n54\t6\t2\n51\t8054\t2\n7\t386\t2\n7\t16440\t2\n7\t18899\t2\n372\t3864\t2\n316\t24150\t2\n105\t2841\t2\n316\t35417\t2\n375\t37914\t2\n500\t2241\t2\n7\t11298\t2\n3993\t49420\t2\n7\t3852\t2\n7\t321\t2\n316\t32704\t2\n316\t33384\t2\n431\t34152\t2\n476\t4784\t2\n12\t185\t2\n375\t37796\t2\n12\t414\t2\n148\t20300\t2\n1\t649\t2\n148\t27217\t2\n213\t12719\t2\n7\t3295\t2\n7\t87\t2\n464\t39727\t2\n7\t18855\t2\n316\t23125\t2\n12\t177\t2\n7\t12427\t2\n7\t18852\t2\n6855\t17796\t2\n316\t867\t2\n316\t32733\t2\n7\t2445\t2\n7\t15380\t2\n7\t18842\t2\n496\t41383\t2\n311\t26557\t2\n1\t298\t2\n146\t20395\t2\n7\t18291\t2\n316\t1181\t2\n7\t20714\t2\n12\t161\t2\n124\t2271\t2\n7\t54410\t2\n30\t33245\t2\n7\t18851\t2\n1\t2879\t2\n42\t44\t2\n330\t20807\t2\n3993\t1090\t2\n316\t8022\t2\n148\t24692\t2\n7\t18873\t2\n7\t18871\t2\n3993\t2628\t2\n1\t337\t2\n124\t456\t2\n316\t29557\t2\n7\t52545\t2\n7\t1603\t2\n479\t16751\t2\n476\t1090\t2\n431\t9933\t2\n479\t50021\t2\n7\t15262\t2\n431\t22714\t2\n7\t6607\t2\n500\t20242\t2\n1\t618\t2\n7\t1087\t2\n7\t15458\t2\n7\t775\t2\n316\t20088\t2\n30\t1093\t2\n316\t32723\t2\n7\t2613\t2\n3993\t2095\t2\n7\t221\t2\n476\t22019\t2\n1616\t48139\t2\n1\t4843\t2\n186\t25887\t2\n30\t346\t2\n7\t2861\t2\n405\t20024\t2\n148\t957\t2\n375\t961\t2\n1\t236\t2\n316\t8878\t2\n7\t5223\t2\n316\t31324\t2\n316\t4826\t2\n333\t10956\t2\n316\t8512\t2\n330\t22497\t2\n416\t31640\t2\n162\t19959\t2\n6124\t1615\t2\n148\t17672\t2\n500\t58280\t2\n316\t68702\t2\n316\t26466\t2\n7\t635\t2\n405\t39696\t2\n7\t18868\t2\n312\t24142\t2\n30\t31410\t2\n7\t15555\t2\n479\t26323\t2\n161\t9372\t2\n375\t37797\t2\n124\t17674\t2\n337\t1588\t2\n132\t20847\t2\n1\t4849\t2\n1\t576\t2\n1\t164\t2\n316\t2213\t2\n1\t867\t2\n1\t637\t2\n316\t5545\t2\n7\t3632\t2\n500\t4207\t2\n330\t24660\t2\n7\t3653\t2\n7738\t64110\t2\n316\t30141\t2\n375\t54020\t2\n46\t6367\t2\n30\t15522\t2\n7\t4196\t2\n37\t769\t2\n431\t12457\t2\n7\t18863\t2\n7\t2817\t2\n476\t52234\t2\n330\t39758\t2\n1\t681\t2\n316\t28443\t2\n121\t4723\t2\n316\t16811\t2\n356\t28562\t2\n148\t170\t2\n316\t26823\t2\n316\t2460\t2\n12\t444\t2\n405\t35524\t2\n7\t18869\t2\n6490\t60060\t2\n148\t21851\t2\n7\t18857\t2\n316\t409\t2\n316\t4796\t2\n316\t2768\t2\n124\t19701\t2\n7\t1838\t2\n398\t37468\t2\n431\t41403\t2\n375\t15939\t2\n438\t36048\t2\n356\t1322\t2\n37\t1075\t2\n8100\t20937\t2\n512\t42402\t2\n7\t18880\t2\n1\t879\t2\n7\t18878\t2\n30\t3801\t2\n148\t8829\t2\n146\t20321\t2\n7\t2766\t2\n12\t6\t2\n316\t3687\t2\n330\t66224\t2\n431\t132\t2\n431\t414\t2\n1\t11390\t2\n1616\t47036\t2\n124\t7809\t2\n375\t32944\t2\n476\t771\t2\n146\t5547\t2\n12\t334\t2\n7\t17706\t2\n1\t16925\t2\n501\t14743\t2\n7\t18847\t2\n7\t18890\t2\n316\t20907\t2\n330\t25749\t2\n12\t321\t2\n7\t320\t2\n148\t20650\t2\n7\t2964\t2\n375\t28140\t2\n431\t16917\t2\n37\t6\t2\n7\t18850\t2\n405\t33633\t2\n405\t39434\t2\n51\t10972\t2\n7\t18879\t2\n479\t33471\t2\n432\t4872\t2\n148\t750\t2\n386\t29522\t2\n1616\t48132\t2\n4033\t50748\t2\n7\t7749\t2\n356\t952\t2\n4049\t15261\t2\n476\t669\t2\n146\t20398\t2\n7\t32043\t2\n479\t62864\t2\n7\t164\t2\n132\t19918\t2\n146\t20396\t2\n316\t32658\t2\n356\t28563\t2\n1\t2759\t2\n375\t32033\t2\n316\t1049\t2\n1616\t50297\t2\n7\t34884\t2\n148\t20078\t2\n124\t3897\t2\n1\t28407\t2\n7\t3897\t2\n132\t19835\t2\n6855\t3687\t2\n312\t20537\t2\n375\t33718\t2\n7\t8178\t2\n7\t3796\t2\n1616\t48869\t2\n1616\t446\t2\n405\t39435\t2\n1\t18857\t2\n476\t10627\t2\n316\t5547\t2\n148\t20048\t2\n337\t4635\t2\n124\t3098\t2\n1\t329\t2\n375\t17535\t2\n405\t20440\t2\n313\t18990\t2\n7\t5462\t2\n311\t4965\t2\n316\t26457\t2\n124\t19171\t2\n1\t950\t2\n312\t26459\t2\n7\t11040\t2\n316\t32582\t2\n7\t7256\t2\n7\t6033\t2\n12\t172\t2\n186\t24310\t2\n7\t1316\t2\n1\t878\t2\n7\t18882\t2\n7\t5367\t2\n132\t19728\t2\n7\t8376\t2\n107\t20111\t2\n316\t3796\t2\n316\t1079\t2\n3993\t502\t2\n7\t18865\t2\n405\t23892\t2\n7\t18860\t2\n316\t18897\t2\n148\t1019\t2\n431\t35139\t2\n330\t346\t2\n316\t21391\t2\n148\t16794\t2\n66\t9263\t2\n46\t6\t2\n124\t17575\t2\n316\t5192\t2\n7\t8829\t2\n316\t14806\t2\n7\t1112\t2\n8\t7022\t2\n1616\t47037\t2\n7\t3\t2\n375\t867\t2\n25\t6\t2\n124\t15584\t2\n405\t39769\t2\n479\t55533\t2\n7\t228\t2\n309\t24137\t2\n330\t29938\t2\n7\t18877\t2\n7\t18866\t2\n7\t358\t2\n7\t6\t2\n6430\t59722\t2\n375\t13975\t2\n7\t6372\t2\n148\t23174\t2\n7\t1980\t2\n187\t19598\t2\n372\t7462\t2\n316\t32721\t2\n124\t17576\t2\n30\t21369\t2\n316\t36290\t2\n30\t33868\t2\n405\t39436\t2\n7\t6602\t2\n1\t687\t2\n148\t19997\t2\n7\t18318\t2\n316\t29453\t2\n3993\t34023\t2\n405\t40513\t2\n7\t23291\t2\n431\t36683\t2\n1\t7657\t2\n148\t29421\t2\n316\t18990\t2\n148\t2146\t2\n7\t22815\t2\n7\t8096\t2\n375\t35647\t2\n316\t35237\t2\n3743\t18743\t2\n7\t18862\t2\n375\t37442\t2\n1\t725\t2\n6855\t1717\t2\n405\t26454\t2\n431\t18861\t2\n7\t12062\t2\n7\t18269\t2\n1\t1044\t2\n1616\t36308\t2\n6855\t61421\t2\n356\t30044\t2\n124\t17672\t2\n5112\t3678\t2\n7\t10501\t2\n148\t27082\t2\n312\t93\t2\n316\t8852\t2\n7\t473\t2\n316\t20064\t2\n405\t9541\t2\n7\t12449\t2\n6855\t23716\t2\n1\t177\t2\n431\t1278\t2\n7\t1736\t2\n375\t1238\t2\n405\t20907\t2\n42\t6\t2\n7\t3041\t2\n1616\t45992\t2\n1616\t50323\t2\n316\t29325\t2\n1616\t53902\t2\n102\t10870\t2\n6855\t409\t2\n160\t20137\t2\n479\t11383\t2\n124\t15512\t2\n405\t2628\t2\n186\t21595\t2\n85\t20113\t2\n405\t904\t2\n7\t18874\t2\n230\t22139\t2\n1\t4855\t2\n146\t346\t2\n8100\t63394\t1\n5889\t59874\t1\n3993\t48548\t1\n498\t45079\t1\n455\t41954\t1\n186\t25427\t1\n186\t21643\t1\n500\t32604\t1\n186\t22790\t1\n107\t18227\t1\n30\t2805\t1\n107\t19534\t1\n330\t24498\t1\n405\t39772\t1\n186\t28460\t1\n312\t164\t1\n230\t21034\t1\n12\t283\t1\n5112\t69937\t1\n504\t65716\t1\n6855\t10287\t1\n7\t43027\t1\n7\t21107\t1\n3993\t66491\t1\n3993\t53311\t1\n356\t28310\t1\n18\t27129\t1\n124\t2616\t1\n426\t15379\t1\n375\t32992\t1\n102\t161\t1\n330\t49892\t1\n186\t24175\t1\n337\t23642\t1\n186\t45848\t1\n8244\t28890\t1\n4480\t63434\t1\n316\t40097\t1\n186\t27232\t1\n498\t44213\t1\n431\t35724\t1\n30\t28737\t1\n6124\t49992\t1\n431\t46860\t1\n186\t27229\t1\n102\t16056\t1\n3872\t11217\t1\n316\t37049\t1\n356\t28358\t1\n500\t66523\t1\n6166\t68731\t1\n479\t3500\t1\n148\t12284\t1\n512\t51511\t1\n313\t29355\t1\n7\t39563\t1\n316\t216\t1\n356\t41021\t1\n186\t28031\t1\n148\t9043\t1\n405\t5325\t1\n186\t40746\t1\n455\t41994\t1\n405\t6717\t1\n186\t28462\t1\n356\t28861\t1\n186\t22876\t1\n94\t10809\t1\n330\t29411\t1\n8244\t69172\t1\n432\t29294\t1\n330\t30902\t1\n529\t34709\t1\n4049\t57757\t1\n160\t1044\t1\n3993\t58258\t1\n3993\t55496\t1\n431\t39081\t1\n432\t34804\t1\n148\t22143\t1\n7\t223\t1\n375\t36284\t1\n393\t698\t1\n191\t25689\t1\n186\t25296\t1\n191\t27628\t1\n4049\t8412\t1\n324\t25328\t1\n3993\t58724\t1\n316\t19717\t1\n30\t3763\t1\n1616\t54733\t1\n477\t59805\t1\n477\t62540\t1\n6124\t60290\t1\n3993\t51981\t1\n479\t48627\t1\n405\t26723\t1\n1\t26305\t1\n3993\t56820\t1\n3993\t26017\t1\n186\t23889\t1\n3993\t56102\t1\n186\t40755\t1\n4042\t903\t1\n132\t20907\t1\n500\t59364\t1\n186\t25541\t1\n375\t6\t1\n353\t26124\t1\n476\t60576\t1\n504\t59595\t1\n498\t46662\t1\n352\t334\t1\n1616\t16187\t1\n6970\t62983\t1\n168\t20757\t1\n356\t40333\t1\n375\t47235\t1\n431\t45757\t1\n30\t2524\t1\n186\t65025\t1\n124\t15393\t1\n431\t36102\t1\n512\t52536\t1\n186\t23117\t1\n356\t37614\t1\n498\t45237\t1\n3993\t66489\t1\n186\t45617\t1\n6855\t69053\t1\n30\t48165\t1\n186\t68696\t1\n426\t265\t1\n476\t30843\t1\n479\t65732\t1\n431\t5610\t1\n298\t38632\t1\n485\t41243\t1\n4033\t50948\t1\n498\t45110\t1\n431\t46642\t1\n30\t4358\t1\n313\t36573\t1\n148\t27546\t1\n368\t32053\t1\n7\t1742\t1\n8100\t460\t1\n330\t538\t1\n186\t22982\t1\n186\t41773\t1\n426\t24270\t1\n148\t24848\t1\n431\t39249\t1\n6855\t65855\t1\n1\t4126\t1\n330\t1006\t1\n375\t49096\t1\n186\t43276\t1\n432\t1038\t1\n186\t38795\t1\n1616\t867\t1\n1\t677\t1\n230\t27033\t1\n432\t7992\t1\n405\t30671\t1\n123\t20735\t1\n51\t2455\t1\n3993\t64910\t1\n102\t18587\t1\n102\t12640\t1\n7\t4973\t1\n186\t24364\t1\n426\t17594\t1\n4033\t49558\t1\n431\t46907\t1\n132\t19861\t1\n186\t23728\t1\n123\t20719\t1\n8100\t65908\t1\n330\t19585\t1\n3993\t52687\t1\n472\t45839\t1\n186\t66207\t1\n54\t9910\t1\n431\t35202\t1\n430\t64755\t1\n7\t58882\t1\n431\t16827\t1\n431\t34404\t1\n316\t66386\t1\n500\t30818\t1\n4350\t56589\t1\n504\t59651\t1\n148\t27380\t1\n431\t39115\t1\n186\t19388\t1\n330\t24653\t1\n405\t16539\t1\n431\t37397\t1\n431\t37407\t1\n186\t7\t1\n330\t32801\t1\n309\t22486\t1\n405\t41946\t1\n311\t26221\t1\n1616\t48855\t1\n5889\t61047\t1\n14\t30373\t1\n3993\t64885\t1\n316\t43102\t1\n5112\t33516\t1\n7\t8291\t1\n105\t17336\t1\n500\t66110\t1\n375\t45778\t1\n186\t33511\t1\n498\t44193\t1\n186\t41406\t1\n3993\t53779\t1\n186\t798\t1\n146\t20121\t1\n316\t66957\t1\n512\t16924\t1\n124\t17709\t1\n431\t39616\t1\n405\t6964\t1\n356\t29194\t1\n479\t39082\t1\n100\t11000\t1\n512\t51154\t1\n3993\t48183\t1\n186\t45919\t1\n186\t44\t1\n7\t5545\t1\n4480\t66328\t1\n499\t29246\t1\n472\t32665\t1\n316\t41557\t1\n124\t19617\t1\n5543\t57427\t1\n3993\t52982\t1\n4350\t61711\t1\n6124\t60303\t1\n5889\t65086\t1\n476\t52664\t1\n3993\t62529\t1\n431\t47124\t1\n186\t29512\t1\n186\t24897\t1\n123\t23480\t1\n186\t26004\t1\n1\t18955\t1\n5889\t59935\t1\n4480\t62446\t1\n431\t41366\t1\n37\t44\t1\n4480\t65765\t1\n431\t34281\t1\n313\t13273\t1\n311\t22653\t1\n5889\t61758\t1\n4688\t55015\t1\n4688\t54969\t1\n432\t13940\t1\n512\t31827\t1\n498\t47079\t1\n5889\t65168\t1\n3993\t20640\t1\n292\t2750\t1\n431\t43073\t1\n186\t18862\t1\n4350\t59977\t1\n330\t40123\t1\n51\t16836\t1\n4480\t64649\t1\n123\t20257\t1\n124\t17710\t1\n186\t55901\t1\n479\t58154\t1\n3993\t50184\t1\n7\t23606\t1\n7\t6221\t1\n3993\t64970\t1\n375\t49909\t1\n30\t29907\t1\n330\t4976\t1\n30\t5184\t1\n316\t32397\t1\n51\t1838\t1\n431\t5646\t1\n30\t2231\t1\n186\t68464\t1\n491\t41189\t1\n500\t22698\t1\n4350\t58093\t1\n431\t37746\t1\n431\t47395\t1\n375\t38531\t1\n431\t24821\t1\n230\t6410\t1\n102\t12749\t1\n7\t3314\t1\n1616\t52302\t1\n191\t25684\t1\n3993\t63329\t1\n4033\t17778\t1\n30\t4337\t1\n<!--TABLE_COMMENT-->\n<font color=red>Results are limited by 1000.</font>"}]},"apps":[],"jobName":"paragraph_1526740885662_-1864222808","id":"20180519-063455_1269900050","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2538","user":"anonymous","dateFinished":"2018-05-19T14:47:48+0000","dateStarted":"2018-05-19T14:47:47+0000"},{"text":"val model = new ALS().\r\n  setSeed(Random.nextLong()).\r\n  setImplicitPrefs(true).\r\n  setRank(10).\r\n  setRegParam(1.0).\r\n  setAlpha(80.0).\r\n  setMaxIter(20).\r\n  setNonnegative(true).\r\n  setUserCol(\"user\").\r\n  setItemCol(\"word\").\r\n  setRatingCol(\"count\").\r\n  setPredictionCol(\"prediction\").\r\n  fit(groupedWordData)\r\n\r\ngroupedWordData.unpersist()","dateUpdated":"2018-05-19T14:47:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"model: org.apache.spark.ml.recommendation.ALSModel = als_43256cc4d8be\nres13: groupedWordData.type = [user: int, word: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1526740885663_-1864607557","id":"20180519-063752_1627408544","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2539","user":"anonymous","dateFinished":"2018-05-19T14:48:41+0000","dateStarted":"2018-05-19T14:47:56+0000"},{"text":"val userID = 8\nval userData = groupedWordData.where(s\"user == $userID\")\n\nz.show(userData.join(wordData, wordData(\"id\") <=> groupedWordData(\"word\"), \"left\"))","dateUpdated":"2018-05-19T15:21:12+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"userID: Int = 8\nuserData: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [user: int, word: int ... 1 more field]\n"},{"type":"TABLE","data":"user\tword\tcount\tname\tid\n8\t3703\t1\twar\t3703\n8\t34\t1\tnull\tnull\n8\t1175\t1\tlast\t1175\n8\t7613\t1\tmaple\t7613\n8\t233\t1\tnull\tnull\n8\t14040\t1\tnull\tnull\n8\t6\t1\thello\t6\n8\t328\t1\tsome\t328\n8\t7436\t1\thand\t7436\n8\t40\t1\tcat\t40\n8\t40\t1\tcat\t40\n8\t250\t1\tstone\t250\n8\t1146\t1\tuntil\t1146\n8\t2779\t1\tpower\t2779\n8\t235\t1\tnull\tnull\n8\t3702\t1\tdatabase\t3702\n8\t6608\t1\tworld\t6608\n8\t9305\t1\tlump\t9305\n8\t6787\t1\tservice\t6787\n8\t3723\t1\tperfect\t3723\n8\t7022\t2\tlake\t7022\n8\t37\t1\tstore\t37\n8\t12697\t1\tnull\tnull\n8\t7107\t1\tfast\t7107\n8\t2777\t1\tremain\t2777\n8\t35\t1\trobot\t35\n8\t7596\t1\tforest\t7596\n8\t9303\t1\tnull\tnull\n8\t7\t1\tword\t7\n8\t7\t1\tword\t7\n8\t7146\t1\tmoon\t7146\n8\t9307\t1\tnull\tnull\n8\t9502\t1\tschema\t9502\n8\t234\t1\tnew\t234\n8\t38\t1\ttranslate\t38\n8\t9310\t1\tproceeding\t9310\n8\t6973\t1\tcar\t6973\n8\t32\t1\tleather\t32\n8\t7149\t1\tlucky\t7149\n8\t33\t4\tmap\t33\n8\t33\t1\tmap\t33\n8\t14\t1\tapple\t14\n8\t3078\t1\tyour\t3078\n8\t9308\t1\tcreate\t9308\n8\t11336\t1\tbuddy\t11336\n8\t7946\t1\tnull\tnull\n8\t8167\t1\ttree\t8167\n8\t9304\t1\tbus\t9304\n8\t9500\t1\tnull\tnull\n8\t7104\t1\tpen\t7104\n8\t36\t1\tsettings\t36\n"}]},"apps":[],"jobName":"paragraph_1526740885663_-1864607557","id":"20180519-063829_765138840","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2540","user":"anonymous","dateFinished":"2018-05-19T15:21:19+0000","dateStarted":"2018-05-19T15:21:12+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526743010226_-1471175830","id":"20180519-151650_335999698","dateCreated":"2018-05-19T15:16:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6991","text":"val toRecommend = model.itemFactors.\n      select($\"id\".as(\"word\")).\n      withColumn(\"user\", lit(userID))\n\nval topRecommendations = model.transform(toRecommend).\n      select(\"word\", \"prediction\").\n      orderBy($\"prediction\".desc).\n      limit(20)\n","dateUpdated":"2018-05-19T15:16:58+0000","dateFinished":"2018-05-19T15:16:58+0000","dateStarted":"2018-05-19T15:16:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"toRecommend: org.apache.spark.sql.DataFrame = [word: int, user: int]\ntopRecommendations: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [word: int, prediction: float]\n"}]}},{"text":"val recommendedWordIDs = topRecommendations.select(\"word\").join(userData, Seq(\"word\"), \"leftanti\").toDF(\"id\")\r\n\r\nval finalTopRecommendations = wordData.join(recommendedWordIDs, \"id\")\r\n\r\nz.show(finalTopRecommendations)","dateUpdated":"2018-05-19T15:22:44+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"recommendedWordIDs: org.apache.spark.sql.DataFrame = [id: int]\nfinalTopRecommendations: org.apache.spark.sql.DataFrame = [id: string, name: string]\n"},{"type":"TABLE","data":"id\tname\n3342\twhat\n38407\tcomplement\n5\tdog\n21651\tfebruary\n294\tvideo\n27981\tpresidents\n20676\tmakes\n7581\tinterfere\n59722\tsugar\n7335\tlive\n19982\tscarce\n7490\tconflicts\n44\tred\n13274\tprogram\n6432\texcessive\n"}]},"apps":[],"jobName":"paragraph_1526740885663_-1864607557","id":"20180519-064027_1975339735","dateCreated":"2018-05-19T14:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2541","user":"anonymous","dateFinished":"2018-05-19T15:23:00+0000","dateStarted":"2018-05-19T15:22:44+0000"},{"dateUpdated":"2018-05-19T14:41:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1526740885666_-1878073769","id":"20180519-065329_1067616418","dateCreated":"2018-05-19T14:41:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2543"}],"name":"Words Recommender","id":"2DDPTCFSB","angularObjects":{"2DGJV6C3B:shared_process":[],"2DEEEHRK1:shared_process":[],"2DDF9V1JR:shared_process":[],"2DF7HENF4:shared_process":[],"2DE26CF87:shared_process":[],"2DFX9TJFK:shared_process":[],"2DE84RE7Y:shared_process":[],"2DDGXF542:shared_process":[],"2DCX3SRBZ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}